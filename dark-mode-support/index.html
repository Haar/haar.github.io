<!DOCTYPE html>
<html lang='en'>
<head>
<title>Tall Guy Rob: Dark Mode Support</title>
<meta content='This blog post covers my addition of support for dark-mode OS setting as shown in the screenshot below. I am quite happy with the visual outcome...' name='description'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='True' name='HandheldFriendly'>
<meta content='Tall Guy Rob' property='og:site_name'>
<meta content='article' property='og:type'>
<meta content='Dark Mode Support' property='og:title'>
<meta content='This blog post covers my addition of support for dark-mode OS setting as shown in the screenshot below. I am quite happy with the visual outcome...' property='og:description'>
<meta content='http://www.tallguyrob.com/dark-mode-support/' property='og:url'>
<meta content='2020-04-12' property='article:published_time'>
<meta content='summary' name='twitter:card'>
<meta content='tallguyrob' name='twitter:site'>
<meta content='Dark Mode Support' name='twitter:title'>
<meta content='This blog post covers my addition of support for dark-mode OS setting as shown in the screenshot below. I am quite happy with the visual outcome...' name='twitter:description'>
<meta content='http://www.tallguyrob.com/dark-mode-support/' name='twitter:url'>
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
<link href="/images/favicon.ico" rel="icon" type="image/ico" />
<link href="/stylesheets/application.css" rel="stylesheet" />
<link href='//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400' rel='stylesheet' type='text/css'>
</head>
<body class='post-template nav-closed'>
<div class='nav'>
<h3 class='nav-title'>Menu</h3>
<a class='nav-close' href='#'>
<span class='hidden'>Close</span>
</a>
<ul>
<li class='nav-home' role='presentation'>
<a href='/'>Home</a>
</li>
</ul>
<a class='subscribe-button icon-feed' href='/feed.xml'>Subscribe</a>
</div>
<span class='nav-cover'></span>

<div class='site-wrapper'>
<header class='main-header no-cover post-head'>
<nav class='main-nav clearfix'>
<a class='menu-button icon-menu' href='#'>
<span class='word'>Menu</span>
</a>
</nav>
</header>
<main class='content' role='main'>
<article class='post'>
<header class='post-header'>
<h1 class='post-title'>Dark Mode Support</h1>
<section class='post-meta'>
<time class='post-date' datetime='2020-04-12'>
12 April 2020
</time>
on <a href='/tag/blog/'>Blog</a>,  and <a href='/tag/front-end/'>front-end</a>
</section>
</header>
<section class='post-content'><p>This blog post covers my addition of support for dark-mode OS setting as shown in the screenshot below. I am quite happy with the visual outcome, though I have yet to add a switch to manually set a preference for this site specifically.</p>

<p><img alt="Screenshot of dark mode and light mode side-by-side" src="/dark-mode-support/Blog.png" /></p>

<h2>The Inspiration</h2>

<p>Inspired by the <a rel="nofollow" href="https://refactoringui.com/">RefactoringUI</a>, I decided to try to better understand aspects of visual design. After wracking my brain trying to think of what I could design/work on, I ended up setting myself a much more conservative goal of familiarising myself with <a rel="nofollow" href="https://www.sketch.com/">Sketch</a> by recreating my existing blog (which uses the Casper theme provided by <a rel="nofollow" href="https://github.com/danielbayerlein/middleman-casper">middleman-casper</a>).</p>

<p>Recreating the blog home-page was quite straight forward after picking up a few tricks from watching the RefactoringUI <a rel="nofollow" href="https://www.youtube.com/channel/UCxqiDtkXtOCNJdckODHk9YA/videos?view=57&amp;flow=grid">videos on Youtube</a>. Having successfully recreated the blog, and tweaked some of the colours to improve readability/accessibility slightly (thanks to <a rel="nofollow" href="https://usecontrast.com/">ContrastApp</a>) I was hungry for the next step.</p>

<p>By great coincidence I heard a <em><strong>&ldquo;ping!&rdquo;</strong></em>, as the StackOverflow blog post email came through announcing Dark Mode support. I thought to myself <em><strong>&ldquo;I can do that&rdquo;</strong></em>, and quickly proceeded to try and figure it out for myself before reading the very good explanation of <a rel="nofollow" href="https://stackoverflow.blog/2020/03/31/building-dark-mode-on-stack-overflow/">how Stack Overflow managed it</a>.</p>

<h2>Going Dark</h2>

<p>Having a complete mockup of my home page made the next steps surprisingly straightforward.</p>

<h3>Creating a colour pallette</h3>

<p>First I had to extract a colour pallette of the general colours used throughout the theme. Some of the colours failed to meet the constrast requirements from ContrastApp, and probably due to my inability to appreciate the subtleties in some of the colour variance I also collapsed certain shades of grey used in my default theme to the following:</p>

<style>
  .pallette-wrapper {
    text-align: center;
    margin-bottom: 1.25em;
  }
  .pallette-sample {
    display:inline-block;
    height:25px;
    width:25px;
    border: 1px solid;
  }
</style>

<div class="pallette-wrapper">
  <div class="pallette-sample" style="background:#FFF"></div>
  <div class="pallette-sample" style="background:#F5F8FA"></div>
  <div class="pallette-sample" style="background:rgba(0,0,0,0.8)"></div>
  <div class="pallette-sample" style="background:rgba(0,0,0,0.5)"></div>
  <div class="pallette-sample" style="background:rgba(255,255,255,0.8)"></div>
  <div class="pallette-sample" style="background:#3A4145"></div>
  <div class="pallette-sample" style="background:#848C93"></div>
  <div class="pallette-sample" style="background:#2E2E2E"></div>
  <div class="pallette-sample" style="background:#111"></div>
  <div class="pallette-sample" style="background:#222"></div>
</div>

<p>Playing around with altering these select values in Sketch I came up with the following dark-mode pallette:</p>

<div class="pallette-wrapper">
  <div class="pallette-sample" style="background:#131313"></div>
  <div class="pallette-sample" style="background:#353c41"></div>
  <div class="pallette-sample" style="background:rgba(255,255,255,0.8)"></div>
  <div class="pallette-sample" style="background:rgba(255,255,255,0.5)"></div>
  <div class="pallette-sample" style="background:rgba(0,0,0,0.8)"></div>
  <div class="pallette-sample" style="background:#75828B"></div>
  <div class="pallette-sample" style="background:#848C93"></div>
  <div class="pallette-sample" style="background:#B1B1B1"></div>
  <div class="pallette-sample" style="background:#848C93"></div>
  <div class="pallette-sample" style="background:#DDD"></div>
</div>

<h3>Extracting values to variables</h3>

<p>I then extracted the usage of these colours into <a rel="nofollow" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties">CSS variables</a> as shown below:</p>
<pre class="highlight css"><code><span class="nd">:root</span> <span class="p">{</span>
  <span class="py">--color-background</span><span class="p">:</span> <span class="m">#FFF</span><span class="p">;</span>
  <span class="py">--color-highlight</span><span class="p">:</span> <span class="m">#F5F8FA</span><span class="p">;</span>
  <span class="py">--color-header-default</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">);</span>
  <span class="py">--color-header-secondary</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.5</span><span class="p">);</span>
  <span class="py">--color-header-inverted</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="m">255</span><span class="p">,</span><span class="m">255</span><span class="p">,</span><span class="m">0.8</span><span class="p">);</span>
  <span class="py">--color-text-default</span><span class="p">:</span> <span class="m">#3A4145</span><span class="p">;</span>
  <span class="py">--color-text-light</span><span class="p">:</span> <span class="m">#848C93</span><span class="p">;</span>
  <span class="py">--color-text-bold</span><span class="p">:</span> <span class="m">#2E2E2E</span><span class="p">;</span>
  <span class="py">--color-text-active</span><span class="p">:</span> <span class="m">#111</span><span class="p">;</span>
  <span class="py">--color-text-secondary</span><span class="p">:</span> <span class="m">#222</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Example usage: */</span>
<span class="nt">body</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="n">--color-text-default</span><span class="p">);</span>
<span class="p">}</span>
</code></pre>

<h3>Dark-mode variable overrides</h3>

<p>Now that we have extracted our colour pallette into variables (and selected out colour pallette for dark-mode), we just need to override the variable values on detecting that the OS is using dark mode. To do that we use the <a rel="nofollow" href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme">prefers-color-scheme</a> media query:</p>
<pre class="highlight css"><code><span class="nd">:root</span> <span class="p">{</span>
  <span class="py">--color-button</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">0.8</span><span class="p">);</span>
  <span class="py">--color-background-code</span><span class="p">:</span> <span class="m">#131313</span><span class="p">;</span>
  <span class="py">--color-text-code</span><span class="p">:</span>  <span class="m">#d0d0d0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@media</span> <span class="p">(</span><span class="n">prefers-color-scheme</span><span class="p">:</span> <span class="n">light</span><span class="p">)</span> <span class="p">{</span>
  <span class="nd">:root</span> <span class="p">{</span>
    <span class="py">--color-background</span><span class="p">:</span> <span class="m">#FFF</span><span class="p">;</span>
    <span class="py">--color-highlight</span><span class="p">:</span> <span class="m">#F5F8FA</span><span class="p">;</span>
    <span class="py">--color-header-default</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.8</span><span class="p">);</span>
    <span class="py">--color-header-secondary</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0.5</span><span class="p">);</span>
    <span class="py">--color-header-inverted</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span><span class="m">255</span><span class="p">,</span><span class="m">255</span><span class="p">,</span><span class="m">0.8</span><span class="p">);</span>
    <span class="py">--color-text-default</span><span class="p">:</span> <span class="m">#3A4145</span><span class="p">;</span>
    <span class="py">--color-text-light</span><span class="p">:</span> <span class="m">#848C93</span><span class="p">;</span>
    <span class="py">--color-text-bold</span><span class="p">:</span> <span class="m">#2E2E2E</span><span class="p">;</span>
    <span class="py">--color-text-active</span><span class="p">:</span> <span class="m">#111</span><span class="p">;</span>
    <span class="py">--color-text-secondary</span><span class="p">:</span> <span class="m">#222</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">@media</span> <span class="p">(</span><span class="n">prefers-color-scheme</span><span class="p">:</span> <span class="n">dark</span><span class="p">)</span> <span class="p">{</span>
  <span class="nd">:root</span> <span class="p">{</span>
    <span class="py">--color-background</span><span class="p">:</span> <span class="m">#131313</span><span class="p">;</span>
    <span class="py">--color-highlight</span><span class="p">:</span> <span class="m">#353c41</span><span class="p">;</span>
    <span class="py">--color-header-default</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">0.8</span><span class="p">);</span>
    <span class="py">--color-header-secondary</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">255</span><span class="p">,</span> <span class="m">0.5</span><span class="p">);</span>
    <span class="py">--color-header-inverted</span><span class="p">:</span> <span class="n">rgba</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0.8</span><span class="p">);</span>
    <span class="py">--color-text-default</span><span class="p">:</span> <span class="m">#75828B</span><span class="p">;</span>
    <span class="py">--color-text-light</span><span class="p">:</span> <span class="m">#848C93</span><span class="p">;</span>
    <span class="py">--color-text-bold</span><span class="p">:</span> <span class="m">#B1B1B1</span><span class="p">;</span>
    <span class="py">--color-text-active</span><span class="p">:</span> <span class="m">#848C93</span><span class="p">;</span>
    <span class="py">--color-text-secondary</span><span class="p">:</span> <span class="m">#ddd</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<h3>Final Tweaks</h3>

<p>The final change I made as part of supporting dark mode was to change my default code-formatting styling from a light background to a dark background. I found this to be the simplest change that would look good on both a light-themed, and dark-themed setup. I found a dark code block on a white background less jarring than the inverse. As I use <a rel="nofollow" href="https://github.com/middleman/middleman-syntax">middleman-syntax</a>, the change was as straight forward as:</p>
<pre class="highlight diff"><code><span class="gd">- &lt;%= Rouge::Themes::Base16.mode(:light).render %&gt;
</span><span class="gi">+ &lt;%= Rouge::Themes::Base16.mode(:dark).render %&gt;
</span></code></pre>

<p>Whilst I was making changes to the styling and HTML of the blog any way, I also included some additional accessibility fixes highlighted by the <a rel="nofollow" href="https://web.dev/measure/">Lighthouse Audit tool</a>.</p>

<p>And that&rsquo;s it! This blog now has dark-mode support for users who have configured their operating system theme.</p>

<p>Thank you for reading!</p>
</section>
<footer class='post-footer'>
<figure class='author-image'>
<a class='img' href='/author/robert-white/' style='background-image: url(https://www.gravatar.com/avatar/cf287f9be7d446cd4afe75daa1c478d3?size=136)'>
<span class='hidden'>Robert White's Picture</span>
</a>
</figure>
<section class='author'>
<h4>
<a href='/author/robert-white/'>Robert White</a>
</h4>
<p></p>
Polyglot Software Developer. Demonstrated Vim-nerd. Currently focused on building reactive systems at Sky Betting and Gaming.
<div class='author-meta'>
<span class='author-location icon-location'>United Kingdom</span>
<span class='author-link icon-link'>
<a href='https://www.tallguyrob.com'>https://www.tallguyrob.com</a>
</span>
</div>
</section>
<section class='share'>
<h4>Share this post</h4>
<a class='icon-twitter' href='https://twitter.com/intent/tweet?text=Dark Mode Support&amp;amp;url=http://www.tallguyrob.com/dark-mode-support/' onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
<span class='hidden'>Twitter</span>
</a>
<a class='icon-facebook' href='https://www.facebook.com/sharer/sharer.php?u=http://www.tallguyrob.com/dark-mode-support/' onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
<span class='hidden'>Facebook</span>
</a>
<a class='icon-google-plus' href='https://plus.google.com/share?url=http://www.tallguyrob.com/dark-mode-support/' onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
<span class='hidden'>Google+</span>
</a>
</section>
</footer>
</article>
</main>
<aside class='read-next'>
<a class='no-cover read-next-story' href='/cheating-at-railway-oriented-programming-in-elixir/'>
<section class='post'>
<h2>Cheating at Railway Oriented Programming in Elixir</h2>
<p>Over the past four months I&rsquo;ve been writing Elixir full-time for backend systems. From this I&rsquo;ll be releasing a&hellip;</p>
</section>
</a>
</aside>

<footer class='site-footer clearfix'>
<section class='copyright'>
&copy;
<a href='/'>Tall Guy Rob</a>
2020
</section>
</footer>
</div>
<script src="/javascripts/application.js"></script>
</body>
</html>
